{"ast":null,"code":"import { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React, { useEffect, useState } from 'react';\nimport ContainerDefault from '~/components/layouts/ContainerDefault';\nimport HeaderDashboard from '~/components/shared/headers/HeaderDashboard';\nimport { connect, useDispatch } from 'react-redux';\nimport { toggleDrawerMenu } from '~/store/app/action';\nimport CategoryRepository from '~/repositories/CategoryRepository';\nimport ProductBrandRepository from '~/repositories/ProductBrandRepository';\nimport { route } from 'next/dist/next-server/server/router';\nimport router, { useRouter } from 'next/router';\nimport { openNotification } from '~/utilities/notification-helpers';\nimport ProductRepository from '~/repositories/ProductRepository';\nimport { Form, Input, notification } from 'antd';\n\nconst CreateProductPage = (_ref) => {\n  let {\n    auth,\n    app\n  } = _ref,\n      props = _objectWithoutProperties(_ref, [\"auth\", \"app\"]);\n\n  const dispatch = useDispatch();\n  const route = useRouter();\n  const {\n    0: product,\n    1: setProduct\n  } = useState({\n    title: \"\",\n    slug: \"\",\n    salePrice: 0,\n    price: 0,\n    vendorId: auth.user.id,\n    isHot: false,\n    isFeatured: false,\n    isOutOfStock: false,\n    isActive: false,\n    categoryId: null,\n    brandId: null,\n    manufacturer: \"\",\n    productImages: null,\n    id: null\n  });\n  const {\n    0: categories,\n    1: setCategories\n  } = useState([]);\n  const {\n    0: brands,\n    1: setBrands\n  } = useState([]);\n\n  const initializeCategories = async () => {\n    const categories = await CategoryRepository.findTopCategory();\n    setCategories([...categories.result]);\n  };\n\n  const initializeBrands = async () => {\n    const brands = await ProductBrandRepository.findAll();\n    setBrands([...brands.result]);\n  };\n\n  const handleSubmit = async e => {\n    if (!product.id) {\n      delete product.id;\n    } //create a formData from a state and add images\n\n\n    const formData = new FormData();\n    Object.keys(product).forEach(key => {\n      if (key === \"productImages\") {\n        if (product.productImages) {\n          for (let i = 0; i < product.productImages.length; i++) {\n            formData.append(\"productImages\", product.productImages[i]);\n          }\n        }\n      } else {\n        formData.append(key, product[key]);\n      }\n    });\n    const result = await ProductRepository.saveProduct(formData);\n\n    if (!result.error) {\n      router.push('/products');\n    } else {\n      openNotification(\"Error Message\", result.error, \"error\");\n    }\n  };\n\n  const initializeProduct = async () => {\n    const fProduct = await ProductRepository.findById(route.query.productId);\n    console.log(fProduct.result);\n\n    if (!fProduct.error) {\n      setProduct(_objectSpread(_objectSpread({}, product), fProduct.result));\n    }\n  };\n\n  useEffect(() => {\n    dispatch(toggleDrawerMenu(false));\n    initializeCategories();\n    initializeBrands();\n    initializeProduct();\n  }, []);\n  return /*#__PURE__*/_jsxs(ContainerDefault, {\n    title: \"Create new product\",\n    children: [/*#__PURE__*/_jsx(HeaderDashboard, {\n      title: \"Create Product\",\n      description: \"Cyamunara Create New Product \"\n    }), /*#__PURE__*/_jsx(\"section\", {\n      className: \"ps-new-item\",\n      children: /*#__PURE__*/_jsxs(Form, {\n        className: \"ps-form ps-form--new-product\",\n        onFinish: handleSubmit,\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: \"ps-form__content\",\n          children: /*#__PURE__*/_jsxs(\"div\", {\n            className: \"row\",\n            children: [/*#__PURE__*/_jsx(\"div\", {\n              className: \"col-xl-6 col-lg-6 col-md-12 col-sm-12 col-12\",\n              children: /*#__PURE__*/_jsxs(\"figure\", {\n                className: \"ps-block--form-box\",\n                children: [/*#__PURE__*/_jsx(\"figcaption\", {\n                  children: \"General\"\n                }), /*#__PURE__*/_jsxs(\"div\", {\n                  className: \"ps-block__content\",\n                  children: [/*#__PURE__*/_jsxs(\"div\", {\n                    className: \"form-group\",\n                    children: [/*#__PURE__*/_jsxs(\"label\", {\n                      children: [\"Product Name\", /*#__PURE__*/_jsx(\"sup\", {\n                        children: \"*\"\n                      })]\n                    }), /*#__PURE__*/_jsx(Form.Item, {\n                      name: \"title\",\n                      rules: [{\n                        required: true,\n                        message: 'Please type Product name!'\n                      }],\n                      children: /*#__PURE__*/_jsx(Input, {\n                        className: \"form-control\",\n                        type: \"text\",\n                        placeholder: \"Enter product name...\",\n                        defaultValue: product.title,\n                        onChange: e => setProduct(_objectSpread(_objectSpread({}, product), {}, {\n                          title: e.target.value\n                        }))\n                      })\n                    })]\n                  }), /*#__PURE__*/_jsxs(\"div\", {\n                    className: \"form-group\",\n                    children: [/*#__PURE__*/_jsxs(\"label\", {\n                      children: [\"Reference\", /*#__PURE__*/_jsx(\"sup\", {\n                        children: \"*\"\n                      })]\n                    }), /*#__PURE__*/_jsx(Form.Item, {\n                      name: \"slug\",\n                      rules: [{\n                        required: true,\n                        message: 'Please type Slug!'\n                      }],\n                      children: /*#__PURE__*/_jsx(Input, {\n                        className: \"form-control\",\n                        type: \"text\",\n                        value: product.slug,\n                        onChange: e => setProduct(_objectSpread(_objectSpread({}, product), {}, {\n                          slug: e.target.value\n                        })),\n                        placeholder: \"Enter product Reference...\"\n                      })\n                    })]\n                  }), /*#__PURE__*/_jsxs(\"div\", {\n                    className: \"form-group\",\n                    children: [/*#__PURE__*/_jsxs(\"label\", {\n                      children: [\"Regular Price\", /*#__PURE__*/_jsx(\"sup\", {\n                        children: \"*\"\n                      })]\n                    }), /*#__PURE__*/_jsx(Form.Item, {\n                      name: \"price\",\n                      rules: [{\n                        required: true,\n                        message: 'Enter price!'\n                      }, {\n                        min: 0,\n                        message: 'Minmum price is 0!'\n                      }],\n                      children: /*#__PURE__*/_jsx(Input, {\n                        className: \"form-control\",\n                        type: \"number\",\n                        placeholder: \"\",\n                        value: product.price,\n                        onChange: e => setProduct(_objectSpread(_objectSpread({}, product), {}, {\n                          price: e.target.value\n                        }))\n                      })\n                    })]\n                  }), /*#__PURE__*/_jsxs(\"div\", {\n                    className: \"form-group\",\n                    children: [/*#__PURE__*/_jsxs(\"label\", {\n                      children: [\"Sale Price\", /*#__PURE__*/_jsx(\"sup\", {\n                        children: \"*\"\n                      })]\n                    }), /*#__PURE__*/_jsx(Form.Item, {\n                      name: \"salePrice\",\n                      rules: [{\n                        required: true,\n                        min: 0,\n                        message: 'Enter sale price!'\n                      }, {\n                        min: 0,\n                        message: 'Minmum price is 0!'\n                      }],\n                      children: /*#__PURE__*/_jsx(Input, {\n                        className: \"form-control\",\n                        type: \"number\",\n                        placeholder: \"\",\n                        value: product.salePrice,\n                        onChange: e => setProduct(_objectSpread(_objectSpread({}, product), {}, {\n                          salePrice: e.target.value\n                        }))\n                      })\n                    })]\n                  }), /*#__PURE__*/_jsxs(\"div\", {\n                    className: \"form-group d-flex\",\n                    children: [/*#__PURE__*/_jsx(Form.Item, {\n                      label: \"Is Hot\",\n                      name: \"isHot\",\n                      children: /*#__PURE__*/_jsx(Input, {\n                        type: \"checkbox\",\n                        className: \"form-control\",\n                        checked: product.isHot,\n                        onChange: e => setProduct(_objectSpread(_objectSpread({}, product), {}, {\n                          isHot: e.target.checked\n                        }))\n                      })\n                    }), /*#__PURE__*/_jsx(Form.Item, {\n                      label: \"Is Featured\",\n                      name: \"isFeatured\",\n                      children: /*#__PURE__*/_jsx(Input, {\n                        type: \"checkbox\",\n                        className: \"form-control\",\n                        checked: product.isFeatured,\n                        onChange: e => setProduct(_objectSpread(_objectSpread({}, product), {}, {\n                          isFeatured: e.target.checked\n                        }))\n                      })\n                    }), /*#__PURE__*/_jsx(Form.Item, {\n                      label: \"Is Active\",\n                      name: \"isActive\",\n                      children: /*#__PURE__*/_jsx(Input, {\n                        type: \"checkbox\",\n                        checked: product.isActive,\n                        onChange: e => setProduct(_objectSpread(_objectSpread({}, product), {}, {\n                          isActive: e.target.checked\n                        }))\n                      })\n                    })]\n                  }), /*#__PURE__*/_jsxs(\"div\", {\n                    className: \"form-group\",\n                    children: [/*#__PURE__*/_jsx(\"label\", {\n                      children: \"Product Description\"\n                    }), /*#__PURE__*/_jsx(Form.Item, {\n                      name: \"description\",\n                      children: /*#__PURE__*/_jsx(\"textarea\", {\n                        className: \"form-control\",\n                        rows: \"6\",\n                        name: \"editordata\"\n                      })\n                    })]\n                  })]\n                })]\n              })\n            }), /*#__PURE__*/_jsx(\"div\", {\n              className: \"col-xl-6 col-lg-6 col-md-12 col-sm-12 col-12\",\n              children: /*#__PURE__*/_jsxs(\"figure\", {\n                className: \"ps-block--form-box\",\n                children: [/*#__PURE__*/_jsx(\"figcaption\", {\n                  children: \"Other info\"\n                }), /*#__PURE__*/_jsxs(\"div\", {\n                  className: \"ps-block__content\",\n                  children: [/*#__PURE__*/_jsxs(\"div\", {\n                    className: \"form-group\",\n                    children: [/*#__PURE__*/_jsx(\"label\", {\n                      children: \"Category\"\n                    }), /*#__PURE__*/_jsx(Form.Item, {\n                      name: \"categoryId\",\n                      rules: [{\n                        required: true,\n                        message: 'Select Product category!'\n                      }],\n                      children: /*#__PURE__*/_jsx(\"select\", {\n                        className: \"form-control\",\n                        value: product.categoryId,\n                        onChange: e => setProduct(_objectSpread(_objectSpread({}, product), {}, {\n                          categoryId: e.target.value\n                        })),\n                        title: \"Status\",\n                        children: categories.map((category, index) => {\n                          return /*#__PURE__*/_jsx(\"option\", {\n                            value: category.id,\n                            children: category.name\n                          }, index);\n                        })\n                      })\n                    })]\n                  }), /*#__PURE__*/_jsxs(\"div\", {\n                    className: \"form-group\",\n                    children: [/*#__PURE__*/_jsx(\"label\", {\n                      children: \"Brand\"\n                    }), /*#__PURE__*/_jsx(Form.Item, {\n                      name: \"brandId\",\n                      rules: [{\n                        required: true,\n                        message: 'Select Product Brand!'\n                      }],\n                      children: /*#__PURE__*/_jsx(\"select\", {\n                        className: \"form-control\",\n                        value: product.brandId,\n                        onChange: e => setProduct(_objectSpread(_objectSpread({}, product), {}, {\n                          brandId: e.target.value\n                        })),\n                        title: \"Brand\",\n                        children: brands.map((brand, index) => /*#__PURE__*/_jsxs(\"option\", {\n                          value: brand.id,\n                          children: [\" \", brand.name]\n                        }, index))\n                      })\n                    })]\n                  }), /*#__PURE__*/_jsxs(\"div\", {\n                    className: \"form-group\",\n                    children: [/*#__PURE__*/_jsx(\"label\", {\n                      children: \"Manufacturer\"\n                    }), /*#__PURE__*/_jsx(Form.Item, {\n                      name: \"manufacturer\",\n                      rules: [{\n                        required: true,\n                        message: 'Enter Product Manufacturer!'\n                      }],\n                      children: /*#__PURE__*/_jsx(\"input\", {\n                        className: \"form-control\",\n                        type: \"text\",\n                        placeholder: \"Enter manufacturer...\",\n                        value: product.manufacturer,\n                        onChange: e => setProduct(_objectSpread(_objectSpread({}, product), {}, {\n                          manufacturer: e.target.value\n                        }))\n                      })\n                    })]\n                  }), /*#__PURE__*/_jsxs(\"div\", {\n                    className: \"form-group\",\n                    children: [/*#__PURE__*/_jsx(\"label\", {\n                      children: \"Product Gallery\"\n                    }), /*#__PURE__*/_jsxs(\"div\", {\n                      className: \"form-group--nest\",\n                      children: [/*#__PURE__*/_jsx(\"input\", {\n                        className: \"form-control\",\n                        type: \"file\",\n                        multiple: true,\n                        onChange: e => setProduct(_objectSpread(_objectSpread({}, product), {}, {\n                          productImages: e.target.files\n                        }))\n                      }), /*#__PURE__*/_jsx(\"button\", {\n                        className: \"ps-btn ps-btn--sm\",\n                        children: \"Choose\"\n                      })]\n                    })]\n                  })]\n                })]\n              })\n            })]\n          })\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          className: \"ps-form__bottom\",\n          children: [/*#__PURE__*/_jsx(\"a\", {\n            className: \"ps-btn ps-btn--black\",\n            href: \"/products\",\n            children: \"Back\"\n          }), /*#__PURE__*/_jsx(\"button\", {\n            className: \"ps-btn ps-btn--gray\",\n            children: \"Cancel\"\n          }), /*#__PURE__*/_jsx(\"button\", {\n            className: \"ps-btn\",\n            type: \"submit\",\n            children: \"Submit\"\n          })]\n        })]\n      })\n    })]\n  });\n};\n\nexport default connect(state => state)(CreateProductPage);","map":null,"metadata":{},"sourceType":"module"}