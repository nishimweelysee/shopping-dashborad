{"ast":null,"code":"import _defineProperty from \"/Users/nishimweelysee/Desktop/eshopping/martfury-admin-react/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"/Users/nishimweelysee/Desktop/eshopping/martfury-admin-react/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _toConsumableArray from \"/Users/nishimweelysee/Desktop/eshopping/martfury-admin-react/node_modules/next/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _asyncToGenerator from \"/Users/nishimweelysee/Desktop/eshopping/martfury-admin-react/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _objectWithoutProperties from \"/Users/nishimweelysee/Desktop/eshopping/martfury-admin-react/node_modules/next/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useEffect, useState } from 'react';\nimport ContainerDefault from '~/components/layouts/ContainerDefault';\nimport HeaderDashboard from '~/components/shared/headers/HeaderDashboard';\nimport { connect, useDispatch } from 'react-redux';\nimport { toggleDrawerMenu } from '~/store/app/action';\nimport CategoryRepository from '~/repositories/CategoryRepository';\nimport ProductBrandRepository from '~/repositories/ProductBrandRepository';\nimport { route } from 'next/dist/next-server/server/router';\nimport router, { useRouter } from 'next/router';\nimport { openNotification } from '~/utilities/notification-helpers';\nimport ProductRepository from '~/repositories/ProductRepository';\nimport { Form, Input, notification } from 'antd';\n\nvar CreateProductPage = function CreateProductPage(_ref) {\n  var auth = _ref.auth,\n      app = _ref.app,\n      props = _objectWithoutProperties(_ref, [\"auth\", \"app\"]);\n\n  var dispatch = useDispatch();\n  var route = useRouter();\n\n  var _useState = useState({\n    title: \"\",\n    slug: \"\",\n    salePrice: 0,\n    price: 0,\n    vendorId: auth.user.id,\n    isHot: false,\n    isFeatured: false,\n    isOutOfStock: false,\n    isActive: false,\n    categoryId: null,\n    brandId: null,\n    manufacturer: \"\",\n    productImages: null,\n    id: null\n  }),\n      product = _useState[0],\n      setProduct = _useState[1];\n\n  var _useState2 = useState([]),\n      categories = _useState2[0],\n      setCategories = _useState2[1];\n\n  var _useState3 = useState([]),\n      brands = _useState3[0],\n      setBrands = _useState3[1];\n\n  var initializeCategories = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var categories;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return CategoryRepository.findTopCategory();\n\n            case 2:\n              categories = _context.sent;\n              setCategories(_toConsumableArray(categories.result));\n\n            case 4:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function initializeCategories() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var initializeBrands = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var brands;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return ProductBrandRepository.findAll();\n\n            case 2:\n              brands = _context2.sent;\n              setBrands(_toConsumableArray(brands.result));\n\n            case 4:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function initializeBrands() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  var handleSubmit = /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(e) {\n      var formData, result;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              if (!product.id) {\n                delete product.id;\n              } //create a formData from a state and add images\n\n\n              formData = new FormData();\n              Object.keys(product).forEach(function (key) {\n                if (key === \"productImages\") {\n                  if (product.productImages) {\n                    for (var i = 0; i < product.productImages.length; i++) {\n                      formData.append(\"productImages\", product.productImages[i]);\n                    }\n                  }\n                } else {\n                  formData.append(key, product[key]);\n                }\n              });\n              _context3.next = 5;\n              return ProductRepository.saveProduct(formData);\n\n            case 5:\n              result = _context3.sent;\n\n              if (!result.error) {\n                router.push('/products');\n              } else {\n                openNotification(\"Error Message\", result.error, \"error\");\n              }\n\n            case 7:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function handleSubmit(_x) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  var initializeProduct = /*#__PURE__*/function () {\n    var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n      var fProduct;\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.next = 2;\n              return ProductRepository.findById(route.query.productId);\n\n            case 2:\n              fProduct = _context4.sent;\n              console.log(fProduct.result);\n\n              if (!fProduct.error) {\n                setProduct(_objectSpread(_objectSpread({}, product), fProduct.result));\n              }\n\n            case 5:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }));\n\n    return function initializeProduct() {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    dispatch(toggleDrawerMenu(false));\n    initializeCategories();\n    initializeBrands();\n    initializeProduct();\n  }, []);\n  return /*#__PURE__*/_jsxs(ContainerDefault, {\n    title: \"Create new product\",\n    children: [/*#__PURE__*/_jsx(HeaderDashboard, {\n      title: \"Create Product\",\n      description: \"Cyamunara Create New Product \"\n    }), /*#__PURE__*/_jsx(\"section\", {\n      className: \"ps-new-item\",\n      children: /*#__PURE__*/_jsxs(Form, {\n        className: \"ps-form ps-form--new-product\",\n        onFinish: handleSubmit,\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: \"ps-form__content\",\n          children: /*#__PURE__*/_jsxs(\"div\", {\n            className: \"row\",\n            children: [/*#__PURE__*/_jsx(\"div\", {\n              className: \"col-xl-6 col-lg-6 col-md-12 col-sm-12 col-12\",\n              children: /*#__PURE__*/_jsxs(\"figure\", {\n                className: \"ps-block--form-box\",\n                children: [/*#__PURE__*/_jsx(\"figcaption\", {\n                  children: \"General\"\n                }), /*#__PURE__*/_jsxs(\"div\", {\n                  className: \"ps-block__content\",\n                  children: [/*#__PURE__*/_jsxs(\"div\", {\n                    className: \"form-group\",\n                    children: [/*#__PURE__*/_jsxs(\"label\", {\n                      children: [\"Product Name\", /*#__PURE__*/_jsx(\"sup\", {\n                        children: \"*\"\n                      })]\n                    }), /*#__PURE__*/_jsx(Form.Item, {\n                      name: \"title\",\n                      rules: [{\n                        required: true,\n                        message: 'Please type Product name!'\n                      }],\n                      children: /*#__PURE__*/_jsx(Input, {\n                        className: \"form-control\",\n                        type: \"text\",\n                        placeholder: \"Enter product name...\",\n                        defaultValue: product.title,\n                        onChange: function onChange(e) {\n                          return setProduct(_objectSpread(_objectSpread({}, product), {}, {\n                            title: e.target.value\n                          }));\n                        }\n                      })\n                    })]\n                  }), /*#__PURE__*/_jsxs(\"div\", {\n                    className: \"form-group\",\n                    children: [/*#__PURE__*/_jsxs(\"label\", {\n                      children: [\"Reference\", /*#__PURE__*/_jsx(\"sup\", {\n                        children: \"*\"\n                      })]\n                    }), /*#__PURE__*/_jsx(Form.Item, {\n                      name: \"slug\",\n                      rules: [{\n                        required: true,\n                        message: 'Please type Slug!'\n                      }],\n                      children: /*#__PURE__*/_jsx(Input, {\n                        className: \"form-control\",\n                        type: \"text\",\n                        value: product.slug,\n                        onChange: function onChange(e) {\n                          return setProduct(_objectSpread(_objectSpread({}, product), {}, {\n                            slug: e.target.value\n                          }));\n                        },\n                        placeholder: \"Enter product Reference...\"\n                      })\n                    })]\n                  }), /*#__PURE__*/_jsxs(\"div\", {\n                    className: \"form-group\",\n                    children: [/*#__PURE__*/_jsxs(\"label\", {\n                      children: [\"Regular Price\", /*#__PURE__*/_jsx(\"sup\", {\n                        children: \"*\"\n                      })]\n                    }), /*#__PURE__*/_jsx(Form.Item, {\n                      name: \"price\",\n                      rules: [{\n                        required: true,\n                        message: 'Enter price!'\n                      }, {\n                        min: 0,\n                        message: 'Minmum price is 0!'\n                      }],\n                      children: /*#__PURE__*/_jsx(Input, {\n                        className: \"form-control\",\n                        type: \"number\",\n                        placeholder: \"\",\n                        value: product.price,\n                        onChange: function onChange(e) {\n                          return setProduct(_objectSpread(_objectSpread({}, product), {}, {\n                            price: e.target.value\n                          }));\n                        }\n                      })\n                    })]\n                  }), /*#__PURE__*/_jsxs(\"div\", {\n                    className: \"form-group\",\n                    children: [/*#__PURE__*/_jsxs(\"label\", {\n                      children: [\"Sale Price\", /*#__PURE__*/_jsx(\"sup\", {\n                        children: \"*\"\n                      })]\n                    }), /*#__PURE__*/_jsx(Form.Item, {\n                      name: \"salePrice\",\n                      rules: [{\n                        required: true,\n                        min: 0,\n                        message: 'Enter sale price!'\n                      }, {\n                        min: 0,\n                        message: 'Minmum price is 0!'\n                      }],\n                      children: /*#__PURE__*/_jsx(Input, {\n                        className: \"form-control\",\n                        type: \"number\",\n                        placeholder: \"\",\n                        value: product.salePrice,\n                        onChange: function onChange(e) {\n                          return setProduct(_objectSpread(_objectSpread({}, product), {}, {\n                            salePrice: e.target.value\n                          }));\n                        }\n                      })\n                    })]\n                  }), /*#__PURE__*/_jsxs(\"div\", {\n                    className: \"form-group d-flex\",\n                    children: [/*#__PURE__*/_jsx(Form.Item, {\n                      label: \"Is Hot\",\n                      name: \"isHot\",\n                      children: /*#__PURE__*/_jsx(Input, {\n                        type: \"checkbox\",\n                        className: \"form-control\",\n                        checked: product.isHot,\n                        onChange: function onChange(e) {\n                          return setProduct(_objectSpread(_objectSpread({}, product), {}, {\n                            isHot: e.target.checked\n                          }));\n                        }\n                      })\n                    }), /*#__PURE__*/_jsx(Form.Item, {\n                      label: \"Is Featured\",\n                      name: \"isFeatured\",\n                      children: /*#__PURE__*/_jsx(Input, {\n                        type: \"checkbox\",\n                        className: \"form-control\",\n                        checked: product.isFeatured,\n                        onChange: function onChange(e) {\n                          return setProduct(_objectSpread(_objectSpread({}, product), {}, {\n                            isFeatured: e.target.checked\n                          }));\n                        }\n                      })\n                    }), /*#__PURE__*/_jsx(Form.Item, {\n                      label: \"Is Active\",\n                      name: \"isActive\",\n                      children: /*#__PURE__*/_jsx(Input, {\n                        type: \"checkbox\",\n                        checked: product.isActive,\n                        onChange: function onChange(e) {\n                          return setProduct(_objectSpread(_objectSpread({}, product), {}, {\n                            isActive: e.target.checked\n                          }));\n                        }\n                      })\n                    })]\n                  }), /*#__PURE__*/_jsxs(\"div\", {\n                    className: \"form-group\",\n                    children: [/*#__PURE__*/_jsx(\"label\", {\n                      children: \"Product Description\"\n                    }), /*#__PURE__*/_jsx(Form.Item, {\n                      name: \"description\",\n                      children: /*#__PURE__*/_jsx(\"textarea\", {\n                        className: \"form-control\",\n                        rows: \"6\",\n                        name: \"editordata\"\n                      })\n                    })]\n                  })]\n                })]\n              })\n            }), /*#__PURE__*/_jsx(\"div\", {\n              className: \"col-xl-6 col-lg-6 col-md-12 col-sm-12 col-12\",\n              children: /*#__PURE__*/_jsxs(\"figure\", {\n                className: \"ps-block--form-box\",\n                children: [/*#__PURE__*/_jsx(\"figcaption\", {\n                  children: \"Other info\"\n                }), /*#__PURE__*/_jsxs(\"div\", {\n                  className: \"ps-block__content\",\n                  children: [/*#__PURE__*/_jsxs(\"div\", {\n                    className: \"form-group\",\n                    children: [/*#__PURE__*/_jsx(\"label\", {\n                      children: \"Category\"\n                    }), /*#__PURE__*/_jsx(Form.Item, {\n                      name: \"categoryId\",\n                      rules: [{\n                        required: true,\n                        message: 'Select Product category!'\n                      }],\n                      children: /*#__PURE__*/_jsx(\"select\", {\n                        className: \"form-control\",\n                        value: product.categoryId,\n                        onChange: function onChange(e) {\n                          return setProduct(_objectSpread(_objectSpread({}, product), {}, {\n                            categoryId: e.target.value\n                          }));\n                        },\n                        title: \"Status\",\n                        children: categories.map(function (category, index) {\n                          return /*#__PURE__*/_jsx(\"option\", {\n                            value: category.id,\n                            children: category.name\n                          }, index);\n                        })\n                      })\n                    })]\n                  }), /*#__PURE__*/_jsxs(\"div\", {\n                    className: \"form-group\",\n                    children: [/*#__PURE__*/_jsx(\"label\", {\n                      children: \"Brand\"\n                    }), /*#__PURE__*/_jsx(Form.Item, {\n                      name: \"brandId\",\n                      rules: [{\n                        required: true,\n                        message: 'Select Product Brand!'\n                      }],\n                      children: /*#__PURE__*/_jsx(\"select\", {\n                        className: \"form-control\",\n                        value: product.brandId,\n                        onChange: function onChange(e) {\n                          return setProduct(_objectSpread(_objectSpread({}, product), {}, {\n                            brandId: e.target.value\n                          }));\n                        },\n                        title: \"Brand\",\n                        children: brands.map(function (brand, index) {\n                          return /*#__PURE__*/_jsxs(\"option\", {\n                            value: brand.id,\n                            children: [\" \", brand.name]\n                          }, index);\n                        })\n                      })\n                    })]\n                  }), /*#__PURE__*/_jsxs(\"div\", {\n                    className: \"form-group\",\n                    children: [/*#__PURE__*/_jsx(\"label\", {\n                      children: \"Manufacturer\"\n                    }), /*#__PURE__*/_jsx(Form.Item, {\n                      name: \"manufacturer\",\n                      rules: [{\n                        required: true,\n                        message: 'Enter Product Manufacturer!'\n                      }],\n                      children: /*#__PURE__*/_jsx(\"input\", {\n                        className: \"form-control\",\n                        type: \"text\",\n                        placeholder: \"Enter manufacturer...\",\n                        value: product.manufacturer,\n                        onChange: function onChange(e) {\n                          return setProduct(_objectSpread(_objectSpread({}, product), {}, {\n                            manufacturer: e.target.value\n                          }));\n                        }\n                      })\n                    })]\n                  }), /*#__PURE__*/_jsxs(\"div\", {\n                    className: \"form-group\",\n                    children: [/*#__PURE__*/_jsx(\"label\", {\n                      children: \"Product Gallery\"\n                    }), /*#__PURE__*/_jsxs(\"div\", {\n                      className: \"form-group--nest\",\n                      children: [/*#__PURE__*/_jsx(\"input\", {\n                        className: \"form-control\",\n                        type: \"file\",\n                        multiple: true,\n                        onChange: function onChange(e) {\n                          return setProduct(_objectSpread(_objectSpread({}, product), {}, {\n                            productImages: e.target.files\n                          }));\n                        }\n                      }), /*#__PURE__*/_jsx(\"button\", {\n                        className: \"ps-btn ps-btn--sm\",\n                        children: \"Choose\"\n                      })]\n                    })]\n                  })]\n                })]\n              })\n            })]\n          })\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          className: \"ps-form__bottom\",\n          children: [/*#__PURE__*/_jsx(\"a\", {\n            className: \"ps-btn ps-btn--black\",\n            href: \"/products\",\n            children: \"Back\"\n          }), /*#__PURE__*/_jsx(\"button\", {\n            className: \"ps-btn ps-btn--gray\",\n            children: \"Cancel\"\n          }), /*#__PURE__*/_jsx(\"button\", {\n            className: \"ps-btn\",\n            type: \"submit\",\n            children: \"Submit\"\n          })]\n        })]\n      })\n    })]\n  });\n};\n\nexport default connect(function (state) {\n  return state;\n})(CreateProductPage);","map":null,"metadata":{},"sourceType":"module"}